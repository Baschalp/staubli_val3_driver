<?xml version="1.0" encoding="utf-8"?>
<Programs xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.staubli.com/robotics/VAL3/Program/2">
  <Program name="encodeJState" access="public">
    <Locals>
      <Local name="l_nRetVal" type="num" xsi:type="array" size="1" />
    </Locals>
    <Code><![CDATA[begin
  // encode 'prefix' and 'header'
  call encPrefixHeader(rosJointMsg.prefix, rosJointMsg.header)

  // encode 'sequence' variable of body message (data)
  l_nRetVal=toBinary(rosJointMsg.jointState.nSeq,1,"-4l",rosJointMsg.body.nData)

  // assuming the remaining elements (6-9) have zeros assigned by default
  rosJointMsg.jointState.nJoints[0]=jCurrPose.j1*nDeg2Rad
  rosJointMsg.jointState.nJoints[1]=jCurrPose.j2*nDeg2Rad
  rosJointMsg.jointState.nJoints[2]=jCurrPose.j3*nDeg2Rad
  rosJointMsg.jointState.nJoints[3]=jCurrPose.j4*nDeg2Rad
  rosJointMsg.jointState.nJoints[4]=jCurrPose.j5*nDeg2Rad
  rosJointMsg.jointState.nJoints[5]=jCurrPose.j6*nDeg2Rad

  // encode 10 values representing joints[10]
  l_nRetVal=toBinary(rosJointMsg.jointState.nJoints,10,"4.0l",rosJointMsg.body.nData[4])
end]]></Code>
  </Program>
</Programs>